# Ανάλυση συναισθήματος περί του εμβολίου κατά του Covid-19 χρησιμοποιώντας δεδομένα Twitter

Το αντικείμενο μελέτης της παρούσας διπλωματικής εργασίας είναι η ανάλυση αναρτήσεων (tweets)
από το μέσο κοινωνικής δικτύωσης Twitter σχετικά με τον εμβολιασμό κατά του covid-19, η κατάταξη της πολικότητάς τους σε θετικά, αρνητικά και ουδέτερα και η σύγκριση των αποτελεσμάτων μεταξύ του διαφορετικών πληθυσμών του κόσμου μέσω της παρουσίασης τους σε χάρτη.

Το Twitter αποτελεί κατάλληλη πλατφόρμα για τέτοιου είδους αναλύσεις καθώς έχει μεγάλη βάση χρηστών
από όλο τον κόσμο (περίπου 330 εκατομμύρια) και παρέχει πρόσβαση σε αναρτήσεις σε πραγματικό χρόνο,
λόγω της φύσης της πλατφόρμας που εστιάζει σε αναρτήσεις μικρού μήκους. Επίσης για κάθε ανάρτηση
παρέχονται πολύ χρήσιμες πληροφορίες όπως τοποθεσία και ετικέτες δίνοντας την δυνατότητα για λεπτομερή
ανάλυση ενός συνόλου δεδομένων.

## Σύνολο Δεδομένων

Το σύνολο αποτελείται από περίπου 230.000 αναρτήσεις που συντάχθηκαν μεταξύ Δεκεμβρίου 2020 και Νοεμβρίου 2021, δηλαδή τον πρώτο χρόνο της κυκλοφορίας των εμβολίων κατά του Covid-19. Τα δεδομένα
συλλέχθηκαν μέσω εξόρυξης πληροφοριών από την ιστοσελίδα του Twitter μέσα σε αυτό το χρονικό διάστημα.

Παρακάτω φαίνεται η κατανομή ανά μήνα:
[Κατανομή αναρτήσεων ανά μήνα](/monthly-count-distribution.png)

Όλες οι αναρτήσεις είναι σε αγγλική γλώσσα και περίπου 160.000 από αυτές περιέχουν πληροφορίες τοποθεσίας. Κάθε ανάρτηση αποτελείται από τα εξής χαρακτηριστικά:

- `id`: Αναγνωριστικό ανάρτησης
- `user_name`: Όνομα χρήστη
- `user_location`: Τοποθεσία χρήστη
- `user_description`: Περιγραφή προφίλ χρήστη
- `user_created`: Ημερομηνία δημιουργίας προφίλ χρήστη
- `user_followers`: Αριθμός ακόλουθων στην πλατφόρμα
- `user_friends`: Αριθμός φίλων στην πλατφόρμα
- `user_favourites`: Αριθμός αγαπημένων χρήστη
- `user_verified`: Αν ο χρήστης έχει επιβεβαιωμένο προφίλ
- `date`: Ημερομηνία ανάρτησης
- `text`: Κείμενο ανάρτησης
- `hashtags`: Ετικέτες ανάρτησης (πχ #covid_vaccine)
- `source`: Συσκευή ανάρτησης (πχ Κινητό Android, iPhone)
- `retweets`: Αριθμός αναδημοσιεύσεων από άλλους χρήστες
- `favorites`: Αριθμός χρηστών που πάτησαν «αγαπημένο» στην ανάρτηση
- `is_retweet`: Αν η ανάρτηση είναι αναδημοσίευση από κάποια άλλη

Για την υλοποίηση χρησιμοποιήθηκαν κυρίως τα πεδία `user_location`, `date`, `text` & `hashtags`.

## Δημοφιλείς ετικέτες

Σε κάθε ανάρτηση υπάρχει η δυνατότητα επισύναψης ετικέτας που βοηθάει στην ομαδοποίηση των tweet που
αναφέρονται στο ίδιο θέμα. Για παράδειγμα, μία ανάρτηση σχετικά με την πανδημία στην ελλάδα θα
μπορούσε να περιέχει τις ετικέτες `#greece` & `#covid19`. Παρακάτω φαίνονται οι 20 πιο δημοφιλείς
ετικέτες του συνόλου καθώς και ο αριθμός των αναρτήσεων που περιέχουν την κάθε μία.

| Ετικέτα        | Αναρτήσεις |
| -------------- | ---------- |
| covaxin        | 58662      |
| moderna        | 44066      |
| covid19        | 19323      |
| sputnikv       | 14500      |
| bbmp           | 14184      |
| vaccine        | 13295      |
| covidvaccine   | 12864      |
| pfizer         | 12218      |
| covishield     | 11432      |
| sinovac        | 10377      |
| sinopharm      | 8301       |
| bengaluru      | 7025       |
| pfizerbiontech | 6548       |
| covid          | 4775       |
| astrazeneca    | 3928       |
| vaccinated     | 3898       |
| vaccines       | 3392       |
| coronavirus    | 2778       |
| urban          | 2769       |
| covid19vaccine | 2751       |

## Αποθήκευση Δεδομένων

Για την αποθήκευση των δεδομένων και των αποτελεσμάτων χρησιμοποιήθηκε η βάση δεδομένων `SQLite`. Η
βάση αυτή παρουσιάζει πολλά πλεονεκτήματα για τον σκοπό της παρούσας εργασίας καθών αποθηκεύει όλα
τα δεδομένα της σε μόνο ένα αρχείο, το οποίο μετά μπορεί να χρησιμοποιηθεί για εκτέλεση ερωτημάτων
γλώσσας SQL πάνω στα δεδομένα.

Για την αναπαράσταση των δεδομένων χρειάστηκαν 2 πίνακες: `tweet` και `country`. Στον πίνακα `tweet`
αποθηκεύθηκαν όλες οι αναρτήσεις και τα αποτελέσματα της επεξεργασίας τους και τον πίνακα `country`
αποθηκεύθηκαν πληροφορίες για κάθε χώρα όπως όνομα, συνολικό πλήθος αναρτήσεων, και πλήθη αναρτήσεων
για κάθε πολικότητα (θετικές, αρνητικές και ουδέτερες).

## Μεθοδολογία

Η υλοποίηση διαιρέθηκε στα παρακάτω στάδια:

1. Προ-επεξεργασία
2. Αξιολόγηση συναισθήματος
3. Εξόρυξη τοποθεσίας
4. Παραγωγή αρχείου τύπου `geojson` για παρουσίαση σε χάρτη
5. Παρουσίαση αποτελεσμάτων σε χάρτη ως web interface

### Προ-επεξεργασία

Για την προ-επεξεργασία των κειμένων χρειάστηκε να αφαιρεθούν όλες οι «λέξεις» που συναντώνται συχνά σε διαδικτυακές αναρτήσεις και δεν συνεισφέρουν στην ανάλυση συναισθημάτων. Αυτό αφορά κυρίως ετικέτες (`#covid`), ονόματα χρηστών (`@user`), σύνδεσμοι και κενοί χαρακτήρες όπως διαστήματα. Δεν έγινε προσπάθεια αφαίρεσης τερματικών χαρακτήρων (stop-words) καθώς το μοντέλο που χρησιμοποιήθηκε για την κατηγοριοποίηση δεν απαιτεί κάποια τέτοια επεξεργασία.

### Αξιολόγηση συναισθήματος

Η κατηγοριοποίηση έγινε με την χρήση της βιβλιοθήκης VADER Sentiment (python), ένα εργαλείο ανάλυσης συναισθημάτων βασισμένο σε λεξικό, εξειδικευμένο για κείμενα κοινωνικών δικτύων.

Μετά το στάδιο της προ-επεξεργασίας κάθε ανάρτηση έλαβε μία αξιολόγηση με όνομα `vader_score`. Η αξιολόγηση αυτή είναι αριθμός που ανήκει στο διάστημα [-1, +1] όπου -1 αντιστοιχεί σε πολύ αρνητικό συναίσθημα και +1 σε πολύ θετικό. Για να κατηγοριοποιηθεί ένα κείμενο ως ουδέτερο σημαίνει ότι αξιολογήθηκε με 0.

Παρακάτω φαίνεται η κατανομή των συναισθημάτων ανά μήνα
[Κατανομή συναισθήματος ανά μήνα](/monthly-sentiment-split.png)

### Εξόρυξη τοποθεσίας

Για την εξόρυξη της τοποθεσίας κάθε ανάρτησης αναλύθηκε το πεδίο `user_location` από κάθε μία.
Για να περιγραφεί η διαδικασία αυτή πρέπει να κατανοηθούν τα παρακάτω δεδομένα σχετικά με τον
τρόπο που συλλέγεται η συγκεκριμένη πληροφορία από την πλατφόρμα του Twitter.

- Οι χρήστες μπορούν να εισάγουν οποιαδήποτε τιμή ώς τοποθεσία κάθε ανάρτησης, ακόμα και αν αυτή δεν αντιστοιχεί σε κάποια τοποθεσία
- To πεδίο μπορεί να αναφέρει το όνομα κάποιας πολιτείας, νομού, πόλης ή χωριού χωρίς να περιέχει το όνομα της χώρας.
- Για χώρες που χρησιμοποιούν αλφάβητα πέρα του λατινικού, η τοποθεσία μπορεί να περιέχει κάποιο τοπώνυμο σε μη-λατινικούς χαρακτήρες.

Για την αντιστοίχηση χρησιμοποιήθηκε μία λίστα με 221 χώρες και τις επίσημες ονομασίες τους. Για την πλειοψηφία των χωρών αυτό ήταν αρκετό για να συλλεχθούν αρκετά δείγματα όμως για κάποιες ειδικές περιπτώσεις σχεδιάστηκαν ειδικοί κανόνες για την συλλογή των τοποθεσιών. Αυτοί οι ειδικοί κανόνες εκφράζονται ως επιπρόσθετοι όροι αναζήτησης στο πεδίο της τοποθεσίας κάθε ανάρτησης. Παρακάτω ακολουθούν μερικά παραδείγματα χωρών:

| Χώρα             | Όροι αναζήτησης                                     | Σχόλια                    |
| ---------------- | --------------------------------------------------- | ------------------------- |
| Ελλάδα           | "Greece", "Hellas", "Athens"                        | Όνομα πρωτεύουσας         |
| ΗΠΑ              | "USA", "US", "California", "Texas", "New York" etc. | Ονόματα πολιτειών των ΗΠΑ |
| Ηνωμένο Βασίλειο | "England", "Scotland", "Wales", "Northern Ireland"  | Ονόματα χωρών του ΗΒ      |

Με την χρήση των παραπάνω αλλά και επιπλέον όρων αναζήτησης για κάθε χώρα καταφέραμε να αντιστοιχίσουμε
περίπου 120.000 από τα 160.000 που περιείχαν τέτοια πληροφορία.

Μετά την εξόρυξη της τοποθεσίας, υπολογίστηκε ο αριθμός θετικών, αρνητικών και ουδέτερων αναρτήσεων και αποθηκεύτηκε για χρήση στο επόμενο στάδιο.

### Παραγωγή αρχείου geojson

Για την παραγωγή του αρχείου `geojson` επιλέχθηκαν οι χώρες που διέθεταν πάνω απο 50 αναρτήσεις (για παρουσίαση πιο αντιπροσωπευτικού δείγματος) και για κάθε μία υπολογίστηκε το ποσοστό θετικών,
αρνητικών και ουδέτερων σε σχέση με τον συνολικό αριθμό αναρτήσεων.

Ύστερα τα ποσοστά αυτά συνδιάστηκαν με χαρτογραφικές πληροφορίες συντεταγμένων για την κάθε χώρα και αποθηκεύθηκαν σε ένα αρχείο τύπου `geojson` για παρουσίαση στον χάρτη της ιστοσελίδας.

### Παρουσίαση των αποτελεσμάτων σε web interface

Για την παρουσίαση των δεδομένων σε χάρτη χρησιμοποιήθηκε η βιβλιοθήκη `leaflet` καθώς και χάρτες από Open Street Maps. Κάθε χώρα χρωματίζεται ανάλογα με το ποσοστό των θετικών αναρτήσεων που διαθέτει και με κάθε κλικ πάνω σε χώρα φαίνονται τα στατιστικά της.

## Αποτελέσματα

Παρόλο που υπάρχει ακόμα πού περιθώριο για περισσότερη μελέτη, μπορούμε να εντοπίσουμε σημαντικές
διαφορές απόψεων μεταξύ χωρών και πληθυσμών. Αυτό μπορεί να οφείλεται σε πολλούς παράγοντες όπως για παράδειγμα η γενικότερη διαχείριση της πανδημίας σε κάθε χώρα. Προφανώς δεν έχουμε αρκετές πληροφορίες για να βγάλουμε τέτοια συμπεράσματα, ο σκοπός της συγκεκριμένης διπλωματικής είναι η ανάλυση δεδομένων και η παρουσίαση των ευρημάτων.

Όπως είδαμε και παραπάνω η κατανομή των συναισθημάτων ανά μήνα έμεινε σχετικά σταθερή με το πλήθος
των αναρτήσεων να φτάνει την μέγιστη τιμή του τον Ιούνιο του 2021.

## Προτεινόμενες βελτιώσεις

Ένα σημαντικό πρόβλημα που συναντήθηκε ήταν η δυσκολία στην απόκτηση των δεδομένων. Η πλατφόρμα του Twitter σταμάτησε την υποστήριξη ακαδημαϊκών εργασιών πολύ πρόσφατα και δεν υπήρχε τρόπος να χρησιμοποιήσουμε τα δεδομένα του μέσω του API. Επίσης έκανε πολύ πιο αυστηρούς τους περιορισμούς για web scraping με αποτέλεσμα να μην υπάρχει τρόπος να επικοινωνήσουμε με την πλατφόρμα για δεδομένα.

Αυτό αντιμετωπίστηκε με την χρήση ανοιχτού συνόλου δεδομένων που είχε αναρτηθεί από τρίτους χρήστες. Για μία πιο ενδελεχή ανάλυση θα χρειαζόταν επικοινωνία με την πλατφόρμα του Twitter και συμφωνία για χρήση του API για ακαδημαϊκό έργο. Δυστυχώς όμως αυτή την περίοδο η πλατφόρμα έχει περιορίσει την επικοινωνία για μη κερδοσκοπικά έργα με αποτέλεσμα να μην έχουμε τρόπο να το υλοποιήσουμε διαφορετικά.
